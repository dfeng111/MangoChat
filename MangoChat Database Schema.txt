-- Create database
CREATE DATABASE IF NOT EXISTS MangoChat;
USE MangoChat;

-- Table for Users
CREATE TABLE IF NOT EXISTS Users (
    UserID INT AUTO_INCREMENT PRIMARY KEY,
    Username VARCHAR(50) NOT NULL,
    Password VARCHAR(100) NOT NULL
);

-- Table for Channels
CREATE TABLE IF NOT EXISTS Channels (
    ChannelID INT AUTO_INCREMENT PRIMARY KEY,
    ChannelName VARCHAR(100) NOT NULL
);

-- Table for User-Channel Relationship
CREATE TABLE IF NOT EXISTS User_Channel (
    UserChanID INT AUTO_INCREMENT PRIMARY KEY,
    UserID INT,
    ChannelID INT,
    FOREIGN KEY (UserID) REFERENCES Users(UserID) ON DELETE CASCADE,
    FOREIGN KEY (ChannelID) REFERENCES Channel(ChannelID) ON DELETE CASCADE,
    UNIQUE(UserID, ChannelID)
);

-- Table for Messages
CREATE TABLE IF NOT EXISTS Messages (
    MessageID INT AUTO_INCREMENT PRIMARY KEY,
    ChannelID INT,
    SenderID INT,
    Content TEXT,
    Timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (ChannelID) REFERENCES Channels(ChannelID) ON DELETE CASCADE,
    FOREIGN KEY (SenderID) REFERENCES Users(UserID) ON DELETE CASCADE
);